---
import { getCollection } from 'astro:content'

import FormattedDate from '@/components/FormattedDate.astro'
import { SITE_TITLE } from '@/consts'
import Layout from '@/layouts/Layout.astro'

const posts = (await getCollection('blog')).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())

const metaTitle = `Blog | ${SITE_TITLE}`
const metaDescription = 'Blog'
---

<Layout {metaTitle} {metaDescription}>
  <div class="mx-auto max-w-2xl">
    <h1 class="text-foreground mb-8 text-4xl font-bold">Blog</h1>

    <div class="space-y-8">
      {
        posts.map(post => (
          <article class="group">
            <a href={`/blog/${post.id}/`} class="block">
              <h2 class="group-hover:text-accent not-odd:text-foreground mb-2 text-xl font-semibold underline transition-colors">
                {post.data.title}
              </h2>
              <p class="text-muted-foreground mb-4 leading-relaxed">{post.data.description}</p>
              <time class="text-muted-foreground text-sm">
                <FormattedDate date={post.data.pubDate} />
              </time>
            </a>

            {/* Decorative separator */}
            <div class="mt-8 text-center">
              <div class="inline-block">
                <svg width="120" height="8" viewBox="0 0 120 8" class="text-muted">
                  <path d="M0 4 Q30 0 60 4 T120 4" stroke="currentColor" fill="none" stroke-width="1" />
                </svg>
              </div>
            </div>
          </article>
        ))
      }
    </div>
  </div>
</Layout>
